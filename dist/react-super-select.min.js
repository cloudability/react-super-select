!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.reactSuperSelect=e()}}(function(){return function e(t,s,i){function a(n,o){if(!s[n]){if(!t[n]){var l="function"==typeof require&&require;if(!o&&l)return l(n,!0);if(r)return r(n,!0);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}var p=s[n]={exports:{}};t[n][0].call(p.exports,function(e){var s=t[n][1][e];return a(s?s:e)},p,p.exports,e,t,s,i)}return s[n].exports}for(var r="function"==typeof require&&require,n=0;n<i.length;n++)a(i[n]);return a}({1:[function(e,t,s){(function(s){"use strict";function i(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var a=e("lodash"),r=e("classnames"),n="undefined"!=typeof window?window.React:"undefined"!=typeof s?s.React:null,o=n.createClass({displayName:"ReactSuperSelect",propTypes:{multiple:n.PropTypes.bool,searchable:n.PropTypes.bool,tags:n.PropTypes.bool,clearable:n.PropTypes.bool,customClass:n.PropTypes.string,customGroupHeadingClass:n.PropTypes.string,customSearchIconClass:n.PropTypes.string,customLoaderClass:n.PropTypes.string,customTagClass:n.PropTypes.string,onChange:n.PropTypes.func.isRequired,ajaxDataFetch:n.PropTypes.func,dataSource:n.PropTypes.oneOfType([n.PropTypes.arrayOf(n.PropTypes.object),n.PropTypes.object]),initialValue:n.PropTypes.oneOfType([n.PropTypes.arrayOf(n.PropTypes.object),n.PropTypes.object]),optionLabelKey:n.PropTypes.string,optionValueKey:n.PropTypes.string,pageDataFetch:n.PropTypes.func,hasMorePages:n.PropTypes.func,groupBy:n.PropTypes.oneOfType([n.PropTypes.string,n.PropTypes.func,n.PropTypes.object]),customGroupHeadingTemplateFunction:n.PropTypes.func,customFilterFunction:n.PropTypes.func,customOptionTemplateFunction:n.PropTypes.func,ajaxErrorString:n.PropTypes.string,noResultsString:n.PropTypes.string,placeholder:n.PropTypes.string,searchPlaceholder:n.PropTypes.string,tagRemoveLabelString:n.PropTypes.string},SEARCH_FOCUS_ID:-1,SELECTED_OPTION_REGEX:/r-ss-selected/,DEFAULT_LOCALIZATIONS:{ajaxErrorString:"An Error occured while fetching options",noResultsString:"No Results Available",placeholder:"Select an Option",searchPlaceholder:"Search",tagRemoveLabelString:"Remove Tag"},getInitialState:function(){return{ajaxError:!1,controlId:a.uniqueId("rss_"),data:this._configureDataSource(this.props.dataSource),rawDataSource:this.props.dataSource,isOpen:!1,focusedId:void 0,labelKey:this.props.optionLabelKey||"name",lastOptionId:a.isArray(this.props.dataSource)&&this.props.dataSource.length>0?this.props.dataSource.length-1:void 0,searchString:void 0,value:this._buildInitialValue(),valueKey:this.props.optionValueKey||"id"}},keymap:{down:40,end:35,enter:13,esc:27,home:36,space:32,tab:9,up:38},lastUserSelectedOption:void 0,componentWillReceiveProps:function(e){var t={};a.isEqual(e.initialValue,this.props.initialValue)||(t.value=this._buildInitialValue(e)),a.isUndefined(e.optionLabelKey)||e.optionLabelKey===this.props.optionLabelKey||(t.labelKey=e.optionLabelKey),a.isUndefined(e.optionValueKey)||e.optionValueKey===this.props.optionValueKey||(t.valueKey=e.optionValueKey),a.isEqual(this.props.dataSource,e.dataSource)||(this.lastUserSelectedOption=void 0,t=a.extend(t,{data:this._configureDataSource(e.dataSource),rawDataSource:e.dataSource,focusedId:void 0,lastOptionId:a.isArray(e.dataSource)&&e.dataSource.length>0?e.dataSource.length-1:void 0})),a.isEmpty(t)||this.setState(t)},componentDidUpdate:function(){this._focusCurrentFocusedId()},componentWillMount:function(){window.addEventListener("click",this._handleClick)},componentWillUnmount:function(){window.removeEventListener("click",this._handleClick)},render:function(){var e,t,s,i,a=this._getDropdownContent(),o=this._getClearButton(),l=r("carat",{down:!this.state.isOpen,up:this.state.isOpen});return i=r("r-ss-wrap",this.props.customClass,{"r-ss-expanded":this.state.isOpen}),s=r("r-ss-trigger",{"r-ss-open":this.state.isOpen,"r-ss-placeholder":this.state.value.length<1,"r-ss-disabled":this.props.disabled,"r-ss-clearable":this.props.clearable}),e=this.props.placeholder?this.props.placeholder:this.DEFAULT_LOCALIZATIONS.placeholder,t=this.state.value.length?this._generateValueDisplay():e,n.createElement("div",{ref:"rssControl",id:this.state.controlId,className:i},n.createElement("div",{ref:"triggerDiv",className:s,onClick:this.toggleDropdown,onKeyDown:this._handleKeyDown,role:"combobox","aria-activedescendant":this._ariaGetActiveDescendentId(),"aria-haspopup":!0,"aria-controls":this._ariaGetListId(),"aria-label":e,"aria-multiselectable":this._isMultiSelect(),tabIndex:"1"},t,o,n.createElement("span",{ref:"carat",className:l}," ")),a)},toggleDropdown:function(){this.props.disabled||this.setState({isOpen:!this.state.isOpen},function(){this.state.isOpen&&this._setFocusOnOpen()})},_ariaGetActiveDescendentId:function(){var e=null,t=this._getFocusedOptionKey();return this.refs[t]&&(e=this.refs[t].props.id),e},_ariaGetListId:function(){return this.state.controlId+"_list"},_buildInitialValue:function(e){e=e||this.props;var t=[];return a.isUndefined(e.initialValue)||(t=a.isArray(e.initialValue)?e.initialValue:[e.initialValue],this._isMultiSelect()||(t=[a.first(t)])),t},_closeOnKeypress:function(){this.state.isOpen&&this.setState({isOpen:!1,focusedId:void 0},this._focusTrigger)},_configureDataSource:function(e){if(a.isArray(e))return e;if(a.isObject(e)){if(a.isArray(e.collection))return e.collection;if(a.isFunction(e.get)){var t=e.get("collection");if(a.isArray(t))return t}}return[]},_defaultSearchFilter:function(e){var t=this.state.searchString.toLowerCase();return a.isString(e[this.state.labelKey])?e[this.state.labelKey].toLowerCase().indexOf(t)>-1:!1},_fetchDataViaAjax:function(){var e=this;this.props.ajaxDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t})},function(){e.setState({ajaxError:!0,rawDataSource:[]})})},_fetchNextPage:function(){var e=this;this.props.pageDataFetch(this.state.rawDataSource).then(function(t){e.setState({ajaxError:!1,data:e._configureDataSource(t),rawDataSource:t,isFetchingPage:!1})},function(){e.setState({ajaxError:!0})})},_filterDataBySearchString:function(e){var t=a.isFunction(this.props.customFilterFunction)?this.props.customFilterFunction:this._defaultSearchFilter;return a.filter(e,t)},_findArrayOfOptionDataObjectsByValue:function(e){var t=a.isArray(e)?a.pluck(e,this.state.valueKey):[e];return a.reject(this.state.data,function(e){return!a.contains(t,e[this.state.valueKey])},this)},_focusCurrentFocusedId:function(){return this.state.focusedId<0?void this._focusSearch():void this._focusDOMOption()},_focusDOMOption:function(){var e=this._getFocusedOptionKey();this.refs[e]&&a.isFunction(this.refs[e].getDOMNode().focus)&&this.refs[e].getDOMNode().focus()},_focusSearch:function(){this.refs.searchInput&&this.refs.searchInput.getDOMNode().focus()},_focusTrigger:function(){this.refs.triggerDiv&&this.refs.triggerDiv.getDOMNode().focus()},_generateValueDisplay:function(){return this.props.tags?this._getTagsDisplayMarkup():this._getNormalDisplayMarkup()},_getAjaxErrorMarkup:function(){var e=this.props.ajaxErrorString?this.props.ajaxErrorString:this.DEFAULT_LOCALIZATIONS.ajaxErrorString;return n.createElement("li",{className:"r-ss-dropdown-option error"},n.createElement("i",{ref:"errorDisplay"},e))},_getDataSource:function(){var e=a.isArray(this.state.data)?this.state.data:[];return a.isString(this.state.searchString)&&(e=this._filterDataBySearchString(e)),this.props.groupBy&&(e=a.groupBy(e,this.props.groupBy)),e},_clearSelection:function(e){var t=[];e.stopPropagation(),this.props.onChange(null),this.setState({value:t})},_getClearButton:function(){var e=null;return this.props.clearable&&!this._isMultiSelect()&&this.state.value.length>0&&(e=n.createElement("span",{className:"r-ss-clearable-button",onClick:this._clearSelection})),e},_getDropdownContent:function(){if(!this.state.isOpen)return null;var e,t,s=this._getSearchContent();return e=this.props.pageDataFetch?this._onMouseMove:null,t=this.state.isFetchingPage?this._getPagingLi():null,n.createElement("div",{ref:"dropdownContent",className:"r-ss-dropdown",onKeyDown:this._handleKeyDown},s,n.createElement("div",{ref:"scrollWrap",className:"r-ss-options-wrap",onMouseMove:e},n.createElement("ul",{className:"r-ss-dropdown-options",ref:"dropdownOptionsList",tabIndex:"-1",id:this._ariaGetListId(),role:"listbox","aria-expanded":this.state.isOpen},this._getOptionsMarkup()),t))},_getFocusedOptionKey:function(){return"option_"+this.state.focusedId},_getGroupHeadingMarkup:function(e){if(!e)return null;var t=r("r-ss-option-group-heading",this.props.customGroupHeadingClass),s="heading_"+e,i=this.props.customGroupHeadingTemplateFunction?this.props.customGroupHeadingTemplateFunction(e):e;return n.createElement("li",{tabIndex:"-1",className:t,key:s,role:"separator","aria-label":e,"aria-hidden":!0},i)},_getNoResultsMarkup:function(){var e=this.props.noResultsString?this.props.noResultsString:this.DEFAULT_LOCALIZATIONS.noResultsString;return n.createElement("li",{className:"r-ss-dropdown-option",tabIndex:"-1"},n.createElement("i",{ref:"noResults"},e))},_getNormalDisplayMarkup:function(){return a.map(this.state.value,function(e){var t="r_ss_selected_"+e[this.state.labelKey];return this.props.customOptionTemplateFunction?this.props.customOptionTemplateFunction(e):n.createElement("span",{key:t,className:"r-ss-selected-label"},e[this.state.labelKey])},this)},_getLoadingMarkup:function(){var e=this.props.customLoaderClass?"r-ss-loader "+this.props.customLoaderClass:"r-ss-loader";return n.createElement("span",{ref:"loader",className:e})},_getOptionIndexFromTarget:function(e){return parseInt(e.getAttribute("data-option-index"),10)},_getOptionsMarkup:function(){if(this._needsAjaxFetch())return this._fetchDataViaAjax(),this._getPagingLi();if(this.state.ajaxError)return this._getAjaxErrorMarkup();var e=this._getDataSource(),t=[],s=0;return a.isArray(e)?t=this._getTemplatedOptions(e):a.forIn(e,function(e,i){t.push(this._getGroupHeadingMarkup(i)),t=t.concat(this._getTemplatedOptions(e,s)),s+=e.length},this),t},_getPagingLi:function(){return n.createElement("li",{key:"page_loading",className:"r-ss-page-fetch-indicator",tabIndex:"-1"},this._getLoadingMarkup())},_getSearchContent:function(){if(!this.props.searchable)return null;var e=this.props.customSearchIconClass?this.props.customSearchIconClass:"r-ss-magnifier",t=this.props.searchPlaceholder?this.props.searchPlaceholder:this.DEFAULT_LOCALIZATIONS.searchPlaceholder,s=this.state.controlId+"_search",i=s+"_label";return n.createElement("div",{className:"r-ss-search-wrap"},n.createElement("div",{className:"r-ss-search-inner"},n.createElement("label",{ref:"searchInputLabel",id:i,className:"r-ss-search-aria-label",htmlFor:s},t),n.createElement("input",{ref:"searchInput",placeholder:t,onClick:this._setFocusIdToSearch,onChange:this._handleSearch,defaultValue:this.state.searchString,name:s,id:s,"aria-labelledby":i,"aria-autocomplete":"list"}),n.createElement("i",{className:e},"search")))},_getTagsDisplayMarkup:function(){return a.map(this.state.value,function(e){return this._getTagMarkup(e)},this)},_getTagMarkup:function(e){var t=e[this.state.labelKey],s=e[this.state.valueKey],i="tag_"+s,a="RemoveTag_"+s,r=this._getTagRemoveIndex(s),o=this.props.tagRemoveLabelString?this.props.tagRemoveLabelString:this.DEFAULT_LOCALIZATIONS.tagRemoveLabelString,l=this.props.customTagClass?"r-ss-tag "+this.props.customTagClass:"r-ss-tag";return o=o+" "+t,n.createElement("span",{className:l,key:i},n.createElement("span",{className:"r-ss-tag-label"},t),n.createElement("button",{"aria-label":o,ref:r,name:a,type:"button",className:"r-ss-tag-remove",onClick:this._removeTagClick.bind(null,e),onKeyDown:this._removeTagKeyPress.bind(null,e)},n.createElement("span",null)))},_getTagRemoveIndex:function(e){return"tag_remove_"+e},_getTemplatedOptions:function(e,t){t=t||0;var s=this._mapDataToOptionsMarkup(e,t);return 0===s.length&&(s=this._getNoResultsMarkup()),s},_handleKeyDown:function(e){if(!this._isUserSearchTypingEvent(e))switch((this.state.isOpen||e.which!==this.keymap.tab)&&(e.stopPropagation(),e.preventDefault()),e.which){case this.keymap.down:this._onDownKey(e);break;case this.keymap.end:this._onEndKey();break;case this.keymap.enter:this._onEnterKey(e);break;case this.keymap.esc:this._onEscKey();break;case this.keymap.home:this._onHomeKey();break;case this.keymap.space:this._onEnterKey(e);break;case this.keymap.tab:this.state.isOpen&&this._onEnterKey(e);break;case this.keymap.up:this._onUpKey(e)}},_handleClick:function(e){e instanceof MouseEvent&&!n.findDOMNode(this.refs.rssControl).contains(e.target)&&this._onEscKey()},_handleSearch:function(e){e.stopPropagation(),e.preventDefault();var t=e.target.value;this._handleSearchDebounced.call(this,t)},_handleSearchDebounced:a.debounce(function(e){this.setState({searchString:e})},300),_isCurrentlySelected:function(e){return a.isArray(this.state.value)?!!a.findWhere(this.state.value,e):a.isEqual(this.state.value,e)},_isMultiSelect:function(){return this.props.multiple||this.props.tags},_isUserSearchTypingEvent:function(e){return!this.refs.searchInput||e.which===this.keymap.down||e.which===this.keymap.up&&e.altKey||e.which===this.keymap.esc?!1:e.target===this.refs.searchInput.getDOMNode()},_mapDataToOptionsMarkup:function(e,t){return a.map(e,function(e,s){s=t+s;var o=this._isCurrentlySelected(e),l="drop_li_"+e[this.state.valueKey],c="option_"+s,p=this.state.controlId+"_aria_"+c,u=a.isFunction(this.props.customOptionTemplateFunction)?this.props.customOptionTemplateFunction(e):e[this.state.labelKey],h=r("r-ss-dropdown-option",i({"r-ss-selected":o},e.className,e.className));return n.createElement("li",{ref:c,id:p,tabIndex:"0","data-option-index":s,className:h,"aria-selected":o,key:l,"data-option-value":e[this.state.valueKey],onClick:this._selectItemOnOptionClick.bind(null,e),role:"option"},u)},this)},_moveFocusDown:function(){if(!this._needsAjaxFetch()){var e;e=a.isUndefined(this.state.focusedId)?this.props.searchable?this.SEARCH_FOCUS_ID:0:this.state.lastOptionId===this.state.focusedId?this.state.lastOptionId:this.state.focusedId+1,this._updateFocusedId(e)}},_moveFocusUp:function(){var e;a.isUndefined(this.state.focusedId)||this.state.focusedId===this.SEARCH_FOCUS_ID||(0===this.state.focusedId?this.props.searchable&&(e=this.SEARCH_FOCUS_ID):e=this.state.focusedId-1),this._updateFocusedId(e)},_needsAjaxFetch:function(){return a.isUndefined(this.state.rawDataSource)&&a.isFunction(this.props.ajaxDataFetch)},_onDownKey:function(e){return this.state.isOpen?(this._moveFocusDown(),void(this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0))):void this.toggleDropdown()},_onEndKey:function(){this.state.lastOptionId&&this._updateFocusedId(this.state.lastOptionId)},_onEnterKey:function(e){if(!this.state.isOpen)return void this.toggleDropdown();if(this._isMultiSelect()&&e.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(e.target);var t=this._isMultiSelect()&&(e.ctrlKey||e.metaKey),s=this.SELECTED_OPTION_REGEX.test(e.target.getAttribute("class"));if(t&&s){var i=a.first(this._findArrayOfOptionDataObjectsByValue(e.target.getAttribute("data-option-value")));this._removeSelectedOptionByValue(i)}else s||this._selectFocusedOption(e.target,t)},_onEscKey:function(){this._closeOnKeypress()},_onHomeKey:function(){this._updateFocusedId(0)},_onMouseMove:function(){if(!this.refs.loader&&!this.state.searchString&&this._pageFetchingComplete()){var e=this.refs.scrollWrap.getDOMNode();e.scrollTop+e.offsetHeight>=e.scrollHeight&&this.setState({isFetchingPage:!0},this._fetchNextPage)}},_onUpKey:function(e){return e.altKey?void this._closeOnKeypress():void(this.state.isOpen&&(this._moveFocusUp(),this._isMultiSelect()&&e.shiftKey&&this._selectFocusedOption(e.target,!0)))},_pageFetchingComplete:function(){return a.isFunction(this.props.hasMorePages)?this.props.hasMorePages(this.state.rawDataSource):!1},_removeAllOptionsInOptionIdRange:function(e,t){for(var s=[],i=t>=e?e:t,r=t>=e?t:e,n=i;r>=n;n++){var o="option_"+n,l=this.refs[o];this.SELECTED_OPTION_REGEX.test(l.props.className)&&this.lastUserSelectedOption.getAttribute("data-option-value")!==l.getDOMNode().getAttribute("data-option-value")&&s.push(l.props["data-option-value"])}var c=a.reject(this.state.value,function(e){return a.includes(s,e[this.state.valueKey])},this);this.props.onChange(c),this.setState({value:c})},_removeSelectedOptionByValue:function(e,t){this.lastUserSelectedOption&&this.lastUserSelectedOption.getAttribute("data-option-value")===e[this.state.valueKey]&&(this.lastUserSelectedOption=void 0);var s=a.reject(this.state.value,function(t){return t[this.state.valueKey]===e[this.state.valueKey]},this);this.props.onChange(s),t=a.isFunction(t)?t:a.noop,this.setState({value:s},t)},_removeTagKeyPress:function(e,t){var s=t.which===this.keymap.enter,i=t.which===this.keymap.space;(s||i)&&(t.preventDefault(),t.stopPropagation(),this._removeSelectedOptionByValue(e,this._setFocusToTagRemovalIfPresent))},_removeTagClick:function(e,t){t.preventDefault(),t.stopPropagation(),this._removeSelectedOptionByValue(e)},_selectAllOptionsInOptionIdRange:function(e,t){for(var s=[],i=t>=e?e:t,r=t>=e?t:e,n=i;r>=n;n++){var o="option_"+n,l=this.refs[o];this.SELECTED_OPTION_REGEX.test(l.props.className)||s.push(l.props["data-option-value"])}var c=a.reduce(this.state.data,function(e,t){return a.includes(s,t[this.state.valueKey])&&e.push(t),e},[],this);this._selectItemByValues(c,!0)},_selectAllOptionsToLastUserSelectedOption:function(e){if(!this.lastUserSelectedOption)return this.lastUserSelectedOption=e,void this._selectAllOptionsInOptionIdRange(0,this._getOptionIndexFromTarget(e));var t=this._getOptionIndexFromTarget(this.lastUserSelectedOption),s=this._getOptionIndexFromTarget(e);this.lastUserSelectedOption=e,this.SELECTED_OPTION_REGEX.test(e.getAttribute("class"))?this._removeAllOptionsInOptionIdRange(t,s):this._selectAllOptionsInOptionIdRange(t,s)},_selectFocusedOption:function(e,t){t=t||!1;var s=this._getFocusedOptionKey();if(this.refs[s]){var i=this.refs[s].props["data-option-value"];if(this.lastUserSelectedOption=e,t&&this.SELECTED_OPTION_REGEX.test(this.refs[s].props.className)){var r=a.first(this._findArrayOfOptionDataObjectsByValue(i));this._removeSelectedOptionByValue(r)}else this._selectItemByValues(i,t)}},_selectItemByValues:function(e,t){var s=this._findArrayOfOptionDataObjectsByValue(e);(this._isMultiSelect()||t&&this.state.value)&&(s=this.state.value.concat(s));var i=this._isMultiSelect()?s:a.first(s);this.props.onChange(i),t?this.setState({value:s}):this.setState({value:s},this._closeOnKeypress)},_selectItemOnOptionClick:function(e,t){if(this._isMultiSelect()&&t.shiftKey)return void this._selectAllOptionsToLastUserSelectedOption(t.currentTarget);var s=this._isMultiSelect()&&(t.ctrlKey||t.metaKey),i=this.SELECTED_OPTION_REGEX.test(t.currentTarget.getAttribute("class"));this.lastUserSelectedOption=t.currentTarget,s&&i?this._removeSelectedOptionByValue(e):i?this._onEscKey():this._selectItemByValues(e[this.state.valueKey],s)},_setFocusIdToSearch:function(){this._updateFocusedId(this.SEARCH_FOCUS_ID)},_setFocusOnOpen:function(){this.lastUserSelectedOption?this._updateFocusedId(parseInt(this.lastUserSelectedOption.getAttribute("data-option-index"),10)):this._moveFocusDown()},_setFocusToTagRemovalIfPresent:function(){if(!this.props.tags||0===this.state.value.length)return!1;var e=a.first(this.state.value)[this.state.valueKey],t=this.refs[this._getTagRemoveIndex(e)];return t&&a.isFunction(t.getDOMNode().focus)?(t.getDOMNode().focus(),!0):!1},_updateFocusedId:function(e){this.setState({focusedId:e})}});t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{classnames:void 0,lodash:void 0}]},{},[1])(1)});